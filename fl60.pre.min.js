(g => {
  let frameLenArr = [ ";" ];

  g.fl60 = callback => {
    let now,
        c,

    generator   = (function*() {for (;;) {yield 16;yield 17;yield 17;}})(),
    getInterval = () => generator.next().value,
    loop        = (callback, prevInt) => {
      let int,
          d;

      frameLenArr.shift();
      frameLenArr.push(d = Date.now() - now);

      now  += d;
      d    -= prevInt;
      int   = Math.max(getInterval() - d, 4);

      callback();
      setTimeout(loop, int, callback, int);
    };

    frameLenArr = Array(60).fill(0).map(x => getInterval());
    c           = getInterval();
    g.fl60      = () => void 0;
    now         = Date.now() - c;
    loop(callback, c);
  }

  g.getFPS = () => {
    let i,
        t = 0;

    for (i = 59; i >= 0 && t < 1000; --i)
      t += frameLenArr[i];

    return (59 - i) * 1000 / t;
  }
})(this);
